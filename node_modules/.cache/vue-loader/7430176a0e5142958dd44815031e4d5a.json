{"remainingRequest":"/Users/user/workspace/pa_center_logistics/vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/user/workspace/pa_center_logistics/vue/src/components/consignees/ConsigneesList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/user/workspace/pa_center_logistics/vue/src/components/consignees/ConsigneesList.vue","mtime":1585147880360},{"path":"/Users/user/workspace/pa_center_logistics/vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/user/workspace/pa_center_logistics/vue/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/user/workspace/pa_center_logistics/vue/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/user/workspace/pa_center_logistics/vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/user/workspace/pa_center_logistics/vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBQYWdlSGVhZGVyIGZyb20gJy4uL2NvbW1vbi9QYWdlSGVhZGVyJwppbXBvcnQgeyBBamF4T3BlcmF0b3IgfSBmcm9tICcuLi8uLi9saWIvYXhpb3MnCmltcG9ydCBkZWJvdW5jZSBmcm9tICdsb2Rhc2guZGVib3VuY2UnCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnY29uc2lnbmVlcy1saXN0JywKICBjb21wb25lbnRzOiB7IFBhZ2VIZWFkZXIgfSwKICBkYXRhICgpIHsKICAgIHJldHVybiB7CiAgICAgIHBlbmRpbmc6IGZhbHNlLAogICAgICBjdXJyZW50X3BhZ2U6IDEsCiAgICAgIGRhdGE6IFtdLAogICAgICB0b3RhbF9yb3dzOiAwLAogICAgICBwZXJfcGFnZTogMjAsCiAgICAgIGZpZWxkczogW3sKICAgICAgICBrZXk6ICdpZCcsCiAgICAgICAgbGFiZWw6ICdJRCcsCiAgICAgICAgc29ydGFibGU6IHRydWUKICAgICAgfSwKICAgICAgewogICAgICAgIGtleTogJ2NvbnNpZ25lZV9uYW1lJywKICAgICAgICBsYWJlbDogJ9Cd0LDQt9Cy0LDQvdC40LUnLAogICAgICAgIHNvcnRhYmxlOiB0cnVlCiAgICAgIH0sCiAgICAgIHsKICAgICAgICBrZXk6ICdjb25zaWduZWVfYWRkcmVzcycsCiAgICAgICAgbGFiZWw6ICfQkNC00YDQtdGB0YEnLAogICAgICAgIHNvcnRhYmxlOiB0cnVlCiAgICAgIH1dLAogICAgICB0YWJsZV9zb3J0aW5nOiB7CiAgICAgICAgc29ydF9ieTogJ2NvbnNpZ25lZV9uYW1lJywKICAgICAgICBzb3J0X2Rlc2M6IHRydWUKICAgICAgfQogICAgfQogIH0sCgogIGNyZWF0ZWQgKCkgewogICAgdGhpcy5nZXRfY29uc2lnbmVlc19saXN0KCkKICB9LAoKICB3YXRjaDogewogICAgdGFibGVfc29ydGluZzogewogICAgICBoYW5kbGVyOiBhc3luYyBmdW5jdGlvbiAobmV3X3RhYmxlX3NvcnRpbmcpIHsKICAgICAgICBkZWJvdW5jZShhc3luYyAobmV3X3RhYmxlX3NvcnRpbmcpID0+IHsKICAgICAgICAgIGlmIChuZXdfdGFibGVfc29ydGluZy5zb3J0X2J5KSB7CiAgICAgICAgICAgIHRoaXMudG9nZ2xlX3BlbmRpbmcoKQogICAgICAgICAgICBuZXcgQWpheE9wZXJhdG9yKCcvY29uc2lnbmVlc19saXN0JywgdGhpcy4kc3RvcmUsICdjb25zaWduZWVzJykuZ2V0KHsKICAgICAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgICAgIHBhZ2U6IHRoaXMuY3VycmVudF9wYWdlLAogICAgICAgICAgICAgICAgbGltaXQ6IHRoaXMucGVyX3BhZ2UsCiAgICAgICAgICAgICAgICBzb3J0X2J5OiBuZXdfdGFibGVfc29ydGluZy5zb3J0X2J5LAogICAgICAgICAgICAgICAgc29ydF9kZXNjOiBuZXdfdGFibGVfc29ydGluZy5zb3J0X2Rlc2MKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgLnRoZW4oZGF0YSA9PiB7CiAgICAgICAgICAgICAgICB0aGlzLmRhdGEgPSBkYXRhLnJlc3VsdAogICAgICAgICAgICAgICAgdGhpcy50b3RhbF9yb3dzID0gZGF0YS50b3RhbAogICAgICAgICAgICAgICAgdGhpcy50b2dnbGVfcGVuZGluZygpCiAgICAgICAgICAgICAgfSkKICAgICAgICAgIH0KICAgICAgICB9LCA1MDApKG5ld190YWJsZV9zb3J0aW5nKQogICAgICB9LAogICAgICBkZWVwOiB0cnVlCiAgICB9CiAgfSwKCiAgbWV0aG9kczogewogICAgdG9nZ2xlX3BlbmRpbmcgKCkgewogICAgICB0aGlzLnBlbmRpbmcgPSAhdGhpcy5wZW5kaW5nCiAgICB9LAoKICAgIGdldF9jb25zaWduZWVzX2xpc3QgKHBhZ2UgPSAxKSB7CiAgICAgIHRoaXMudG9nZ2xlX3BlbmRpbmcoKQogICAgICBuZXcgQWpheE9wZXJhdG9yKGAvY29uc2lnbmVlc19saXN0YCwgdGhpcy4kc3RvcmUsICdjb25zaWduZWVzJykuZ2V0KHsKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIHBhZ2UsCiAgICAgICAgICBsaW1pdDogdGhpcy5wZXJfcGFnZSwKICAgICAgICAgIHNvcnRfYnk6IHRoaXMudGFibGVfc29ydGluZy5zb3J0X2J5LAogICAgICAgICAgc29ydF9kZXNjOiB0aGlzLnRhYmxlX3NvcnRpbmcuc29ydF9kZXNjCiAgICAgICAgfQogICAgICB9KQogICAgICAgIC50aGVuKGRhdGEgPT4gewogICAgICAgICAgdGhpcy5kYXRhID0gW10KICAgICAgICAgIHRoaXMuZGF0YSA9IGRhdGEucmVzdWx0CiAgICAgICAgICB0aGlzLnRvdGFsX3Jvd3MgPSBkYXRhLnRvdGFsCiAgICAgICAgICB0aGlzLnRvZ2dsZV9wZW5kaW5nKCkKICAgICAgICAgIHJldHVybiB0aGlzLmRhdGEKICAgICAgICB9KQogICAgICAgIC5jYXRjaChlID0+IHsKICAgICAgICAgIHRoaXMudG9nZ2xlX3BlbmRpbmcoKQogICAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDQpIHRoaXMuJHJvdXRlci5wdXNoKHsgbmFtZTogJ2xvZ2luJywgcGFyYW1zOiB7IGVycm9yX3RleHQ6ICfQktC+0LnQtNGC0LjRgtC1INCyINC70LjRh9C90YvQuSDQutCw0LHQuNC90LXRgicgfSB9KQogICAgICAgIH0pCiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["ConsigneesList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ConsigneesList.vue","sourceRoot":"src/components/consignees","sourcesContent":["<template>\n  <div>\n    <div>\n    <page-header title=\"Список грузополучателей\"></page-header>\n    <b-table id=\"products_list\" hover small no-local-sorting\n             :busy=\"pending\"\n             :items=\"data\"\n             :fields=\"fields\"\n             :sort-by.sync=\"table_sorting.sort_by\"\n             :sort-desc.sync=\"table_sorting.sort_desc\"\n             :current-page=\"current_page\">\n      <template v-slot:table-busy>\n        <div class=\"text-center text-danger my-2\">\n          <b-spinner class=\"align-middle\"></b-spinner>\n          <strong>Загрузка...</strong>\n        </div>\n      </template>\n    </b-table>\n    <b-pagination v-model=\"current_page\"\n                :total-rows=\"total_rows\"\n                :per-page=\"per_page\"\n                @change=\"get_consignees_list\"\n                aria-controls=\"products_list\"></b-pagination>\n  </div>\n  </div>\n</template>\n\n<script>\nimport PageHeader from '../common/PageHeader'\nimport { AjaxOperator } from '../../lib/axios'\nimport debounce from 'lodash.debounce'\nexport default {\n  name: 'consignees-list',\n  components: { PageHeader },\n  data () {\n    return {\n      pending: false,\n      current_page: 1,\n      data: [],\n      total_rows: 0,\n      per_page: 20,\n      fields: [{\n        key: 'id',\n        label: 'ID',\n        sortable: true\n      },\n      {\n        key: 'consignee_name',\n        label: 'Название',\n        sortable: true\n      },\n      {\n        key: 'consignee_address',\n        label: 'Адресс',\n        sortable: true\n      }],\n      table_sorting: {\n        sort_by: 'consignee_name',\n        sort_desc: true\n      }\n    }\n  },\n\n  created () {\n    this.get_consignees_list()\n  },\n\n  watch: {\n    table_sorting: {\n      handler: async function (new_table_sorting) {\n        debounce(async (new_table_sorting) => {\n          if (new_table_sorting.sort_by) {\n            this.toggle_pending()\n            new AjaxOperator('/consignees_list', this.$store, 'consignees').get({\n              params: {\n                page: this.current_page,\n                limit: this.per_page,\n                sort_by: new_table_sorting.sort_by,\n                sort_desc: new_table_sorting.sort_desc\n              }\n            })\n              .then(data => {\n                this.data = data.result\n                this.total_rows = data.total\n                this.toggle_pending()\n              })\n          }\n        }, 500)(new_table_sorting)\n      },\n      deep: true\n    }\n  },\n\n  methods: {\n    toggle_pending () {\n      this.pending = !this.pending\n    },\n\n    get_consignees_list (page = 1) {\n      this.toggle_pending()\n      new AjaxOperator(`/consignees_list`, this.$store, 'consignees').get({\n        params: {\n          page,\n          limit: this.per_page,\n          sort_by: this.table_sorting.sort_by,\n          sort_desc: this.table_sorting.sort_desc\n        }\n      })\n        .then(data => {\n          this.data = []\n          this.data = data.result\n          this.total_rows = data.total\n          this.toggle_pending()\n          return this.data\n        })\n        .catch(e => {\n          this.toggle_pending()\n          if (e.response.status === 404) this.$router.push({ name: 'login', params: { error_text: 'Войдтите в личный кабинет' } })\n        })\n    }\n  }\n}\n</script>\n"]}]}