{"remainingRequest":"/Users/user/workspace/pa_center_logistics/vue/node_modules/babel-loader/lib/index.js!/Users/user/workspace/pa_center_logistics/vue/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/user/workspace/pa_center_logistics/vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/user/workspace/pa_center_logistics/vue/src/components/product/ProductsList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/user/workspace/pa_center_logistics/vue/src/components/product/ProductsList.vue","mtime":1586954425831},{"path":"/Users/user/workspace/pa_center_logistics/vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/user/workspace/pa_center_logistics/vue/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/user/workspace/pa_center_logistics/vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/user/workspace/pa_center_logistics/vue/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZyI7CmltcG9ydCAicmVnZW5lcmF0b3ItcnVudGltZS9ydW50aW1lIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IFBhZ2VIZWFkZXIgZnJvbSAnLi4vY29tbW9uL1BhZ2VIZWFkZXInOwppbXBvcnQgeyBBamF4T3BlcmF0b3IgfSBmcm9tICcuLi8uLi9saWIvYXhpb3MnOwppbXBvcnQgZGVib3VuY2UgZnJvbSAnbG9kYXNoLmRlYm91bmNlJzsKaW1wb3J0IFByb2R1Y3RDcmVhdGUgZnJvbSAnLi9Qcm9kdWN0Q3JlYXRlJzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdwcm9kdWN0cy1saXN0JywKICBjb21wb25lbnRzOiB7CiAgICBQcm9kdWN0Q3JlYXRlOiBQcm9kdWN0Q3JlYXRlLAogICAgUGFnZUhlYWRlcjogUGFnZUhlYWRlcgogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHBlbmRpbmc6IGZhbHNlLAogICAgICBjdXJyZW50X3BhZ2U6IDEsCiAgICAgIGRhdGE6IFtdLAogICAgICB0b3RhbF9yb3dzOiAwLAogICAgICBwZXJfcGFnZTogMjAsCiAgICAgIGZpZWxkczogW3sKICAgICAgICBrZXk6ICd2ZW5kb3JfY29kZScsCiAgICAgICAgbGFiZWw6ICfQkNGA0YLQuNC60YPQuycsCiAgICAgICAgc29ydGFibGU6IHRydWUKICAgICAgfSwgewogICAgICAgIGtleTogJ25hbWUnLAogICAgICAgIGxhYmVsOiAn0J3QsNC30LLQsNC90LjQtScsCiAgICAgICAgc29ydGFibGU6IHRydWUKICAgICAgfSwgewogICAgICAgIGtleTogJ3Byb2R1Y3RzX2dyb3VwJywKICAgICAgICBsYWJlbDogJ9CT0YDRg9C/0L/QsCcsCiAgICAgICAgc29ydGFibGU6IHRydWUKICAgICAgfSwgewogICAgICAgIGtleTogJ2Nvc3QnLAogICAgICAgIGxhYmVsOiAn0KHQvtGC0LjQvNC+0YHRgtGMJywKICAgICAgICBzb3J0YWJsZTogdHJ1ZQogICAgICB9LCB7CiAgICAgICAgbGFiZWw6ICfQodGC0LDRgtGD0YEnCiAgICAgIH1dLAogICAgICB0YWJsZV9zb3J0aW5nOiB7CiAgICAgICAgc29ydF9ieTogJ25hbWUnLAogICAgICAgIHNvcnRfZGVzYzogZmFsc2UKICAgICAgfSwKICAgICAgaXNfY3JlYXRlOiBmYWxzZQogICAgfTsKICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB0aGlzLmdldF9wcm9kdWN0c19saXN0KCk7CiAgfSwKICB3YXRjaDogewogICAgdGFibGVfc29ydGluZzogewogICAgICBoYW5kbGVyOiBmdW5jdGlvbiBoYW5kbGVyKG5ld190YWJsZV9zb3J0aW5nKSB7CiAgICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBoYW5kbGVyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGRlYm91bmNlKGZ1bmN0aW9uIF9jYWxsZWUobmV3X3RhYmxlX3NvcnRpbmcpIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS5hc3luYyhmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobmV3X3RhYmxlX3NvcnRpbmcuc29ydF9ieSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMudG9nZ2xlX3BlbmRpbmcoKTsKCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgQWpheE9wZXJhdG9yKCdwcm9kdWN0c19saXN0JywgX3RoaXMuJHN0b3JlLCAncHJvZHVjdHMnKS5nZXQoewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYWdlOiBfdGhpcy5jdXJyZW50X3BhZ2UsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGltaXQ6IF90aGlzLnBlcl9wYWdlLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNvcnRfYnk6IG5ld190YWJsZV9zb3J0aW5nLnNvcnRfYnksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc29ydF9kZXNjOiBuZXdfdGFibGVfc29ydGluZy5zb3J0X2Rlc2MKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAoZGF0YSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfdGhpcy5kYXRhID0gZGF0YS5yZXN1bHQ7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnRvdGFsX3Jvd3MgPSBkYXRhLnRvdGFsOwoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMudG9nZ2xlX3BlbmRpbmcoKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgMToKICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9LCA1MDApKG5ld190YWJsZV9zb3J0aW5nKTsKCiAgICAgICAgICAgICAgY2FzZSAxOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQyLnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9LAogICAgICBkZWVwOiB0cnVlCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICB0b2dnbGVfcGVuZGluZzogZnVuY3Rpb24gdG9nZ2xlX3BlbmRpbmcoKSB7CiAgICAgIHRoaXMucGVuZGluZyA9ICF0aGlzLnBlbmRpbmc7CiAgICB9LAogICAgZ2V0X3Byb2R1Y3RzX2xpc3Q6IGZ1bmN0aW9uIGdldF9wcm9kdWN0c19saXN0KCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHZhciBwYWdlID0gYXJndW1lbnRzLmxlbmd0aCA+IDAgJiYgYXJndW1lbnRzWzBdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMF0gOiAxOwogICAgICB0aGlzLnRvZ2dsZV9wZW5kaW5nKCk7CiAgICAgIG5ldyBBamF4T3BlcmF0b3IoJ3Byb2R1Y3RzX2xpc3QnLCB0aGlzLiRzdG9yZSwgJ3Byb2R1Y3RzJykuZ2V0KHsKICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgIHBhZ2U6IHBhZ2UsCiAgICAgICAgICBsaW1pdDogdGhpcy5wZXJfcGFnZSwKICAgICAgICAgIHNvcnRfYnk6IHRoaXMudGFibGVfc29ydGluZy5zb3J0X2J5LAogICAgICAgICAgc29ydF9kZXNjOiB0aGlzLnRhYmxlX3NvcnRpbmcuc29ydF9kZXNjCiAgICAgICAgfQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChkYXRhKSB7CiAgICAgICAgX3RoaXMyLmRhdGEgPSBbXTsKICAgICAgICBfdGhpczIuZGF0YSA9IGRhdGEucmVzdWx0OwogICAgICAgIF90aGlzMi50b3RhbF9yb3dzID0gZGF0YS50b3RhbDsKCiAgICAgICAgX3RoaXMyLnRvZ2dsZV9wZW5kaW5nKCk7CgogICAgICAgIHJldHVybiBfdGhpczIuZGF0YTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGUpIHsKICAgICAgICBfdGhpczIudG9nZ2xlX3BlbmRpbmcoKTsKCiAgICAgICAgaWYgKGUucmVzcG9uc2Uuc3RhdHVzID09PSA0MDQpIF90aGlzMi4kcm91dGVyLnB1c2goewogICAgICAgICAgbmFtZTogJ2xvZ2luJywKICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICBlcnJvcl90ZXh0OiAn0JLQvtC50LTRgtC40YLQtSDQsiDQu9C40YfQvdGL0Lkg0LrQsNCx0LjQvdC10YInCiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfQogIH0KfTs="},{"version":3,"sources":["ProductsList.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <page-header title=\"Список товаров\">\n      <template slot=\"actions\">\n        <b-button variant=\"warning\" squared class=\"d-flex align-items-center\" @click=\"is_create = !is_create\">\n          <img src=\"../../assets/plus-warning-filled.png\" width=\"24\" hight=\"24\"/>\n          <span>Создать заявку</span>\n        </b-button>\n      </template>\n    </page-header>\n    <product-create v-if=\"is_create\"\n                    @close=\"is_create = $event\"\n                    title=\"Новая заявка на добавление товара\"\n    ></product-create>\n    <b-table id=\"products_list\" hover small no-local-sorting\n             style=\"border: 2px solid white; font-size: 13px; line-height: 16px\"\n             :busy=\"pending\"\n             :items=\"data\"\n             :fields=\"fields\"\n             :sort-by.sync=\"table_sorting.sort_by\"\n             :sort-desc.sync=\"table_sorting.sort_desc\"\n             :current-page=\"current_page\">\n      <template v-slot:table-busy>\n        <div class=\"text-center text-danger my-2\">\n          <b-spinner class=\"align-middle\"></b-spinner>\n          <strong>Загрузка...</strong>\n        </div>\n      </template>\n    </b-table>\n    <b-pagination v-model=\"current_page\"\n                :total-rows=\"total_rows\"\n                :per-page=\"per_page\"\n                @change=\"get_products_list\"\n                aria-controls=\"products_list\"></b-pagination>\n  </div>\n</template>\n\n<script>\nimport PageHeader from '../common/PageHeader'\nimport { AjaxOperator } from '../../lib/axios'\nimport debounce from 'lodash.debounce'\nimport ProductCreate from './ProductCreate'\nexport default {\n  name: 'products-list',\n  components: { ProductCreate, PageHeader },\n  data () {\n    return {\n      pending: false,\n      current_page: 1,\n      data: [],\n      total_rows: 0,\n      per_page: 20,\n      fields: [{\n        key: 'vendor_code',\n        label: 'Артикул',\n        sortable: true\n      },\n      {\n        key: 'name',\n        label: 'Название',\n        sortable: true\n      },\n      {\n        key: 'products_group',\n        label: 'Группа',\n        sortable: true\n      },\n      {\n        key: 'cost',\n        label: 'Сотимость',\n        sortable: true\n      },\n      {\n        label: 'Статус'\n      }],\n      table_sorting: {\n        sort_by: 'name',\n        sort_desc: false\n      },\n      is_create: false\n    }\n  },\n\n  created () {\n    this.get_products_list()\n  },\n\n  watch: {\n    table_sorting: {\n      handler: async function (new_table_sorting) {\n        debounce(async (new_table_sorting) => {\n          if (new_table_sorting.sort_by) {\n            this.toggle_pending()\n            new AjaxOperator('products_list', this.$store, 'products').get({\n              params: {\n                page: this.current_page,\n                limit: this.per_page,\n                sort_by: new_table_sorting.sort_by,\n                sort_desc: new_table_sorting.sort_desc\n              }\n            })\n              .then(data => {\n                this.data = data.result\n                this.total_rows = data.total\n                this.toggle_pending()\n              })\n          }\n        }, 500)(new_table_sorting)\n      },\n      deep: true\n    }\n  },\n\n  methods: {\n    toggle_pending () {\n      this.pending = !this.pending\n    },\n\n    get_products_list (page = 1) {\n      this.toggle_pending()\n      new AjaxOperator('products_list', this.$store, 'products').get({\n        params: {\n          page,\n          limit: this.per_page,\n          sort_by: this.table_sorting.sort_by,\n          sort_desc: this.table_sorting.sort_desc\n        }\n      })\n        .then(data => {\n          this.data = []\n          this.data = data.result\n          this.total_rows = data.total\n          this.toggle_pending()\n          return this.data\n        })\n        .catch(e => {\n          this.toggle_pending()\n          if (e.response.status === 404) this.$router.push({ name: 'login', params: { error_text: 'Войдтите в личный кабинет' } })\n        })\n    }\n  }\n}\n</script>\n"],"sourceRoot":"src/components/product"}]}